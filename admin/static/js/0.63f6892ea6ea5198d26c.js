webpackJsonp([0],{Svqo:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("Dd8w"),o=s.n(a),n=s("NYxO"),i=s("F2ih"),l=s("BuIE"),r={components:{Editor:function(){return s.e(9).then(s.bind(null,"x4kh"))}},computed:{is_add:function(){return"AddPosts"===this.$route.name}},data:function(){return{save_loading:!1,posts:{_meta:{}},old_path:""}},watch:{$route:{immediate:!0,handler:function(){this.get_posts_info()}}},methods:o()({},Object(n.b)(["get_posts","update_posts","create_posts","delete_posts"]),{get_date:function(){var t=new Date;return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()},default_post_info:function(){return{_meta:{layout:"post"},_date:this.get_date()}},get_posts_info:function(){var t=this;if(this.is_add)this.posts=this.default_post_info();else{var e=this.$route.params.path;this.get_posts(e).then(function(e){t.posts=Object(i.a)(e),t.old_path=e.path})}},save:function(){var t=this,e=function(t){var e={path:"_posts/"+t._date+"-"+t._title+".md"},s=function(t){t.maker="gitpress";var e="---";for(var s in t)e+="\n",e+=s+": "+t[s];return e+="\n",e+="---",e+="\n"}(o()({},t.meta,{update:Date.now(),title:t._title}))+t._content;return e.content=l.a.encode(s),t.sha&&(e.sha=t.sha),e}(this.posts);this.posts._title&&(this.save_loading=!0,(this.is_add?this.create_posts:this.update_posts)(e).then(function(s){t.save_loading=!1,t.save_after(s,e)}).catch(function(e){t.save_loading=!1}))},save_after:function(t,e){var s=this.old_path!=e.path,a="添加成功";this.is_add||(a="更新成功",s&&this.delete_posts({path:this.old_path,sha:e.sha})),this.$router.push({name:"EditPosts",params:{path:t.content.path}}),this.$msg.success(a)}})},p={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-container",[s("el-main",{staticClass:"bg-f p-d-15"},[s("div",{staticClass:"m-b-10"},[s("el-input",{attrs:{size:"mini",placeholder:"文章标题"},model:{value:t.posts._title,callback:function(e){t.$set(t.posts,"_title",e)},expression:"posts._title"}})],1),t._v(" "),s("div",[s("Editor",{model:{value:t.posts._content,callback:function(e){t.$set(t.posts,"_content",e)},expression:"posts._content"}})],1)]),t._v(" "),s("el-aside",{staticClass:"bg-f p-d-15 m-l-10",attrs:{width:"250px"}},[s("div",[s("el-form",{attrs:{size:"mini","label-width":"3em","label-position":"left"}},[s("el-form-item",{attrs:{label:"模板"}},[s("el-select",{model:{value:t.posts._meta.layout,callback:function(e){t.$set(t.posts._meta,"layout",e)},expression:"posts._meta.layout"}},[s("el-option",{attrs:{value:"post",label:"post"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"标签"}},[s("el-input",{model:{value:t.posts._meta.categories,callback:function(e){t.$set(t.posts._meta,"categories",e)},expression:"posts._meta.categories"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"时间"}},[s("el-input",{attrs:{disabled:""},model:{value:t.posts._date,callback:function(e){t.$set(t.posts,"_date",e)},expression:"posts._date"}})],1),t._v(" "),s("el-form-item",[s("el-button",{attrs:{loading:t.save_loading},on:{click:t.save}},[t._v("\n                        "+t._s(t.is_add?"添加":"保存")+"\n                    ")])],1)],1)],1)])],1)},staticRenderFns:[]},d=s("VU/8")(r,p,!1,null,null,null);e.default=d.exports}});